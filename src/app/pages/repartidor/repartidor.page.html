<ion-header>
  <ion-toolbar color="light" class="header-toolbar">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Repartidor</ion-title>
  </ion-toolbar>
</ion-header>
<ion-menu contentId="main-content" side="start">
  <ion-header>
    <ion-toolbar color="light">
      <ion-title>Menú</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item button routerLink="/perfil">
        <ion-icon name="person-circle-outline" slot="start"></ion-icon>
        <ion-label>Perfil</ion-label>
      </ion-item>
      <!-- Puedes agregar más opciones aquí -->
    </ion-list>
  </ion-content>
</ion-menu>

<ion-content id="main-content" [fullscreen]="true" class="ion-padding custom-bg">


  <div class="container">

    <!-- Avatar -->
    <ion-avatar class="avatar">
      <img src="assets/usuario.png" alt="Avatar" />
    </ion-avatar>

    <!-- Mandado Actual -->
    <!-- Mandado Actual -->
    <h2 class="titulo">Mandado Actual</h2>

    <ion-card class="pedido-card">
      <ion-item lines="none" *ngIf="pedidoActual; else sinActual">
        <ion-icon name="navigate-outline" slot="start"></ion-icon>
        <ion-label>
          <h3>{{ pedidoActual?.categoria?.nombre || 'Pedido' }}</h3>
          <p>De: {{ pedidoActual?.lugar_recoleccion?.colonia }} → A: {{ pedidoActual?.lugar_entrega?.colonia }}</p>
          <p>Estatus: {{ estatusActual(pedidoActual) }}</p>
          <p>Precio: ${{ pedidoActual?.precio }}</p>
        </ion-label>

        <!-- Acciones según estatus -->
        <ng-container [ngSwitch]="estatusActual(pedidoActual)">
          <ion-button *ngSwitchCase="'Aceptado'" fill="solid" color="primary" size="small" (click)="iniciarCamino()">
            Iniciar (En camino)
          </ion-button>
          <ion-button *ngSwitchCase="'En camino'" fill="solid" color="success" size="small" (click)="marcarEntregado()">
            Marcar entregado
          </ion-button>
          <ion-button *ngSwitchDefault fill="clear" color="medium" size="small" disabled>
            Sin acciones
          </ion-button>
        </ng-container>
      </ion-item>

      <ng-template #sinActual>
        <ion-item lines="none">
          <ion-icon name="time-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>No tienes mandados en curso</h3>
            <p>Acepta uno de los disponibles para comenzar</p>
          </ion-label>
        </ion-item>
      </ng-template>
    </ion-card>


    <!-- Buscador -->
    <ion-searchbar [(ngModel)]="filtro" placeholder="Buscar pedidos" class="custom-search"></ion-searchbar>

    <!-- Mandados disponibles -->
    <h2 class="titulo">Mandados disponibles</h2>
    <ion-card class="pedido-card" *ngFor="let pedido of pedidosFiltrados()" (click)="mostrarAlerta(pedido)">
      <ion-item lines="none">
        <ion-icon name="navigate-outline" slot="start"></ion-icon>
        <ion-label>
          <h3>{{ pedido?.categoria?.nombre || 'Pedido' }}</h3>
          <p>De: {{ pedido?.lugar_recoleccion?.colonia }} → A: {{ pedido?.lugar_entrega?.colonia }}</p>
          <p>Precio: ${{ pedido?.precio }}</p>
        </ion-label>
        <ion-button fill="clear" color="dark" size="small">
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </ion-item>
    </ion-card>

  </div>
</ion-content>
