<ion-header>
  <ion-toolbar color="light" class="header-toolbar">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Usuario</ion-title>
  </ion-toolbar>
</ion-header>

<ion-menu contentId="main-content" side="start">
  <ion-header>
    <ion-toolbar color="light">
      <ion-title>Menú</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item button routerLink="/perfil">
        <ion-icon name="person-circle-outline" slot="start"></ion-icon>
        <ion-label>Perfil</ion-label>
      </ion-item>
      <!-- Puedes agregar más opciones aquí -->
    </ion-list>
  </ion-content>
</ion-menu>

<ion-content id="main-content" [fullscreen]="true" class="ion-padding custom-bg">


  <!-- VISTA 1: Mandados actuales -->
  <div *ngIf="!mostrarFormulario">

    <!-- Imagen de usuario -->
    <div class="profile-container">
      <ion-avatar class="profile-avatar">
        <img src="assets/usuario.png" alt="avatar" />
      </ion-avatar>
    </div>

    <!-- Mandado Actual -->
    <div class="mandado-title">Mandado Actual</div>

      <!-- Tarjeta principal -->
  <ion-card class="pedido-card">
    <ion-item lines="none">
      <ion-icon name="navigate-outline" slot="start"></ion-icon>
      <ion-label>
        <h2>Estado del pedido</h2>
        <p>Descripción del objeto</p>
        <p>Hora</p>
      </ion-label>
      <ion-button fill="clear" color="dark" size="small">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-card>

    <!-- Tabs entregados / en proceso -->
    <div class="tabs-container">
      <span
        class="tab"
        [ngClass]="{ active: currentTab === 'entregados' }"
        (click)="changeTab('entregados')"
      >
        Entregados
      </span>
      <span
        class="tab"
        [ngClass]="{ active: currentTab === 'enProceso' }"
        (click)="changeTab('enProceso')"
      >
        En proceso
      </span>
    </div>

    <!-- Contenido según pestaña -->
    <div *ngIf="currentTab === 'enProceso'">
      <ion-card class="pedido-card">
        <ion-item lines="none">
          <ion-icon name="navigate-outline" slot="start"></ion-icon>
          <ion-label>
            <h2>Estado del pedido</h2>
            <p>Descripción del objeto</p>
            <p>Hora</p>
          </ion-label>
          <ion-button fill="clear" color="dark" size="small">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </ion-item>
      </ion-card>
    </div>

    <div *ngIf="currentTab === 'entregados'">
      <ion-card class="pedido-card">
        <ion-item lines="none">
          <ion-icon name="checkmark-done-outline" slot="start"></ion-icon>
          <ion-label>
            <h2>Pedido entregado</h2>
            <p>Descripción del objeto</p>
            <p>Hora</p>
          </ion-label>
        </ion-item>
      </ion-card>
    </div>

    <!-- Botón solicitar mandado -->
    <div class="btn-container">
      <ion-button expand="block" shape="round" color="light" (click)="mostrarFormulario = true">
        Solicitar Mandado
      </ion-button>
    </div>
  </div>

 <!-- ...encabezado igual... -->

<!-- VISTA 2: Formulario para solicitar -->

<div *ngIf="mostrarFormulario">
  <h2 class="form-title">Solicita un Mandado</h2>

  <div class="image-container">
    <img src="assets/mandado.png" alt="Paquete" />
  </div>

  <!-- Categoría -->
  <ion-item class="custom-input" lines="none">
  <ion-select placeholder="Categoría" [(ngModel)]="categoriaId" name="categoria" interface="alert">
    <ion-select-option *ngFor="let c of categorias" [value]="c.id">{{ c.nombre }}</ion-select-option>
    <ion-select-option *ngIf="categorias.length === 0" disabled value="">
      (sin categorías)
    </ion-select-option>
  </ion-select>
</ion-item>


  <!-- Dirección de recolección (ID existente) -->
  <ion-item class="custom-input" lines="none">
    <ion-select placeholder="Lugar de recolección" [(ngModel)]="recoleccionId" name="recoleccion" interface="popover">
      <ion-select-option *ngFor="let d of direcciones" [value]="d.id">
        {{ d.calle }} #{{ d.num_casa }} ({{ d.colonia }})
      </ion-select-option>
      <ion-select-option *ngIf="direcciones.length === 0" disabled value="">
        (agrega una dirección primero)
      </ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Dirección de entrega -->
  <ion-item class="custom-input" lines="none">
    <ion-select placeholder="Lugar de entrega" [(ngModel)]="entregaId" name="entrega" interface="popover">
      <ion-select-option *ngFor="let d of direcciones" [value]="d.id">
        {{ d.calle }} #{{ d.num_casa }} ({{ d.colonia }})
      </ion-select-option>
      <ion-select-option *ngIf="direcciones.length === 0" disabled value="">
        (agrega una dirección primero)
      </ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Precio -->
  <div class="slider-container">
    <div class="labels">
      <span>Precio</span>
      <span>$0-100</span>
    </div>
    <ion-range min="0" max="100" [(ngModel)]="precio" pin="true"></ion-range>
  </div>

  <!-- Notas -->
  <ion-input type="text" placeholder="Notas (opcional)" fill="solid" class="custom-input" [(ngModel)]="notas"></ion-input>

  <div class="btn-container">
    <ion-button expand="block" shape="round" color="light" (click)="enviarSolicitud()">
      Solicitar
    </ion-button>
    <ion-button expand="block" fill="clear" (click)="mostrarFormulario = false">
      Cancelar
    </ion-button>
  </div>
</div>


